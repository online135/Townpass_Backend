<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Notifications</title>
    <script>
        // Function to fetch categories and populate the dropdown
        function fetchCategories() {
            fetch('http://192.168.1.102:8080/api/rss/categories')
                .then(response => response.json())
                .then(data => {
                    // Find the dropdown element
                    const dropdown = document.getElementById('categoriesDropdown');
                    dropdown.innerHTML = ''; // Clear existing options
                    
                    // Create a default option
                    const defaultOption = document.createElement('option');
                    defaultOption.text = 'Select a category';
                    defaultOption.value = '';
                    dropdown.appendChild(defaultOption);

                    // Populate dropdown with fetched categories
                    data.forEach(category => {
                        const option = document.createElement('option');
                        option.text = category.displayName; // Assuming each category has a 'name' field
                        option.value = category.code;  // Assuming each category has an 'id' field
                        dropdown.appendChild(option);
                    });
                })
                .catch(error => {
                    console.error('Error fetching categories:', error);
                    alert('Failed to load categories.');
                });
        }
    </script>
</head>
<body>
    <h1>Notifications</h1>

    <!-- Button to fetch and populate the dropdown -->
    <button onclick="fetchCategories()">Fetch Categories</button>

    <!-- Dropdown to display fetched categories -->
    <select id="categoriesDropdown">
        <option value="">Select a category</option>
    </select>

    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Category</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="notification : ${notifications}">
                <td th:text="${notification.id}"></td>
                <td th:text="${notification.category}"></td>
            </tr>
        </tbody>
    </table>
</body>
</html>